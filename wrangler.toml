name = "sahajcloud"
compatibility_date = "2025-11-27"
main = ".open-next/worker.js"
compatibility_flags = ["nodejs_compat"]

# Sentry version tracking
[version_metadata]
binding = "CF_VERSION_METADATA"

# Workers.dev subdomain configuration
# Set to false to disable *.workers.dev routes (use custom domains instead)
workers_dev = false

# Preview URLs configuration
# Set to true to enable preview URLs for testing deployments
preview_urls = false

[observability]
enabled = false

[assets]
directory = ".open-next/assets"
binding = "ASSETS"

# D1 Database Binding
[[d1_databases]]
binding = "D1"
database_name = "sahajcloud"
database_id = "8e3e8272-5bb2-478b-ad7b-4e803ce6694d"
remote = true

# R2 Storage Binding
[[r2_buckets]]
binding = "R2"
bucket_name = "sahajcloud"
jurisdiction = "eu"
remote = true

# Environment Variables (non-sensitive)
[vars]
NODE_ENV = "production"
SAHAJCLOUD_URL = "https://cloud.sydevelopers.com"
WEMEDITATE_WEB_URL = "https://wemeditate.com"
SAHAJATLAS_URL = "https://atlas.sydevelopers.com"

# Cloudflare Services Configuration
# Account-level identifiers and delivery URLs (public, non-sensitive)
CLOUDFLARE_ACCOUNT_ID = "c66c53a69689eb030b228c450515fff2"  # Find in: Dashboard → Account Home → right sidebar
CLOUDFLARE_IMAGES_DELIVERY_URL = "https://imagedelivery.net/dOm4imjweFFL1Pto29l-4Q"  # Full URL: https://imagedelivery.net/<hash>
CLOUDFLARE_STREAM_DELIVERY_URL = "https://customer-aorobtik2fce41s5.cloudflarestream.com"  # Full URL: https://customer-<code>.cloudflarestream.com
CLOUDFLARE_R2_DELIVERY_URL = "https://assets.sydevelopers.com"  # Custom domain for R2

# Sentry Configuration
# Set via: wrangler secret put SENTRY_DSN
# SENTRY_DSN = "https://your-dsn@sentry.io/project-id"

# Secrets (sensitive - set via wrangler secret put)
# See .env.example for list of required secrets
# Set with: wrangler secret put <SECRET_NAME>

# Build Configuration
[build]
command = "WRANGLER_BUILD_CONDITIONS=\"\" WRANGLER_BUILD_PLATFORM=\"node\" pnpm exec opennextjs-cloudflare build"

# ========================================
# Development Environment
# ========================================
# Use this environment for local development
# Start with: PORT=4567 pnpm dev

[env.dev]
name = "sahajcloud-dev"
main = ".next/standalone/server.js"
workers_dev = true
preview_urls = true

# Sentry version tracking
[env.dev.version_metadata]
binding = "CF_VERSION_METADATA"

# D1 Database Binding (local development uses SQLite file)
[[env.dev.d1_databases]]
binding = "D1"
database_name = "sahajcloud-dev"
database_id = "local"

# R2 Storage Binding
[[env.dev.r2_buckets]]
binding = "R2"
bucket_name = "sahajcloud-dev"
jurisdiction = "eu"

# Environment Variables
[env.dev.vars]
NODE_ENV = "development"
SAHAJCLOUD_URL = "http://localhost:3000"
WEMEDITATE_WEB_URL = "http://localhost:5173"
SAHAJATLAS_URL = "http://localhost:5174"

# Cloudflare Services (optional in development - falls back to local storage if not set)
CLOUDFLARE_ACCOUNT_ID = ""
CLOUDFLARE_IMAGES_DELIVERY_URL = ""
CLOUDFLARE_STREAM_DELIVERY_URL = ""
CLOUDFLARE_R2_DELIVERY_URL = ""
